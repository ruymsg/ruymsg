import java.awt.*;
import java.awt.event.*;  


public class Calculator extends Frame {
	public boolean setClear=true;  
	double number, memValue;  
	char op;
	
	String digitButtonText[] = {"7", "8", "9", "4", "5", "6", "1", "2", "3", "0", "." };  
	String operatorButtonText[] = {"/", "*", "-", "+", "=" };  
	String specialButtonText[] = {"Off", "C", "CE" };
	
	MyDigitButton digitButton[] = new MyDigitButton[digitButtonText.length];  
	MyOperatorButton operatorButton[] = new MyOperatorButton[operatorButtonText.length];  
	MySpecialButton specialButton[] = new MySpecialButton[specialButtonText.length];
	
	Label displayLabel = new Label("0", Label.RIGHT);  
  
	final int FRAME_WIDTH = 340, FRAME_HEIGHT = 450;  
	final int HEIGHT = 50, WIDTH = 50, H_SPACE = 10, V_SPACE = 10;  
	final int TOPX = 50, TOPY = 50;
	
	
	Calculator(String frameText) {	// constructor  
		super(frameText);  
	  
		int tempX = TOPX, tempY = TOPY;  
		displayLabel.setBounds(tempX, tempY, 240, HEIGHT);  
		displayLabel.setBackground(Color.GREEN);  
		displayLabel.setForeground(Color.BLACK);  
		add(displayLabel);  
		
		// set Coordinates for Special Buttons  
		tempX = TOPX;
		tempY = TOPY + 1 * (HEIGHT + V_SPACE);  
		for(int i = 0; i < specialButton.length; i++) {
			specialButton[i] = new MySpecialButton(tempX, tempY, WIDTH, HEIGHT, specialButtonText[i], this);  
			specialButton[i].setForeground(Color.RED);  
			tempX = tempX + WIDTH + H_SPACE;  
		}  
  
		// set Coordinates for Digit Buttons  
		int digitX = TOPX;  
		int digitY = TOPY + 2 * (HEIGHT + V_SPACE);
		tempX = digitX;
		tempY = digitY; 
		for(int i = 0; i < digitButton.length; i++) {  
			digitButton[i] = new MyDigitButton(tempX, tempY, WIDTH, HEIGHT, digitButtonText[i], this);  
			digitButton[i].setForeground(Color.BLUE);  
			tempX += WIDTH + H_SPACE;  
			if((i + 1) % 3 == 0) {
				tempX = digitX;
				tempY += HEIGHT + V_SPACE;
			}  
		}  
  
		// set Coordinates for Operator Buttons  
		int opsX = digitX + 2 * (WIDTH + H_SPACE) + H_SPACE;  
		int opsY = digitY;  
		tempX = opsX;
		tempY = opsY;
		for(int i = 0; i < operatorButton.length - 1; i++) {  
			tempX += WIDTH + H_SPACE;  
			operatorButton[i] = new MyOperatorButton(tempX, tempY, WIDTH, HEIGHT, operatorButtonText[i], this);  
			operatorButton[i].setForeground(Color.RED);  
			tempX = opsX;
			tempY += HEIGHT + V_SPACE;
		}
		// set Coordinates for "=" operator
		tempX = digitX + 2 * (WIDTH + H_SPACE);
		tempY = digitY + 3 * (HEIGHT + V_SPACE);
		operatorButton[operatorButton.length - 1] = new MyOperatorButton(tempX, tempY, WIDTH, HEIGHT, operatorButtonText[operatorButton.length - 1], this);  
		operatorButton[operatorButton.length - 1].setForeground(Color.RED);
  
		addWindowListener(new WindowAdapter() { 
			public void windowClosing(WindowEvent ev) { 
				System.exit(0);
			}  
		});  
  
		setLayout(null);  
		setSize(FRAME_WIDTH, FRAME_HEIGHT);  
		setVisible(true);  
	}	// constructor
	
	
	static String getFormattedText(double temp) {
		String resText = "" + temp;  
		if(resText.lastIndexOf(".0") > 0)  
		    resText = resText.substring(0, resText.length() - 2);  
		return resText;  
	}
	
	
	public static void main(String []args) {  
		new Calculator("Calculator");  
	}  
}	// class Calculator


class MyDigitButton extends Button implements ActionListener {
	Calculator cl;  
	  

	MyDigitButton(int x,int y, int width, int height, String cap, Calculator clc) {
		super(cap);  
		setBounds(x, y, width, height);  
		this.cl = clc;  
		this.cl.add(this);  
		addActionListener(this);  
	}  


	static boolean isInString(String s, char ch) { 
		for(int i = 0; i < s.length(); i++)
			if(s.charAt(i) == ch)
				return true;  
		return false;  
	}  

 
	public void actionPerformed(ActionEvent ev) {
		String tempText = ((MyDigitButton)ev.getSource()).getLabel();  
	  
		if(tempText.equals(".")) {  
			if(cl.setClear) {  
		    	cl.displayLabel.setText("0.");
		    	cl.setClear = false;
			}  
			else if(!isInString(cl.displayLabel.getText(), '.'))  
				cl.displayLabel.setText(cl.displayLabel.getText() + ".");  
			return;  
		}  
	  
		int index = 0;  
		try{  
			index = Integer.parseInt(tempText);  
		}
		catch(NumberFormatException e) {
			return;
		}  
		  
		if (index==0 && cl.displayLabel.getText().equals("0"))
			return;  
	  
		if(cl.setClear) {
	    	cl.displayLabel.setText("" + index);
	    	cl.setClear = false;
	    }  
		else  
			cl.displayLabel.setText(cl.displayLabel.getText() + index);
	}	// actionPerformed  
}	// class MyDigitButton


class MyOperatorButton extends Button implements ActionListener {
	Calculator cl;  
	  
	MyOperatorButton(int x,int y, int width, int height, String cap, Calculator clc) {
		super(cap);  
		setBounds(x, y, width, height);  
		this.cl = clc;  
		this.cl.add(this);  
		addActionListener(this);  
	}  


	public void actionPerformed(ActionEvent ev) {
		String opText = ((MyOperatorButton)ev.getSource()).getLabel();  
		  
		cl.setClear = true;  
		double temp = Double.parseDouble(cl.displayLabel.getText());  
		  
		if(!opText.equals("=")) {
		    cl.number = temp;  
		    cl.op = opText.charAt(0);  
		    return;  
		}  

		switch(cl.op) {  
			case '+':  
			    temp += cl.number;
			    break;  
			case '-':  
			    temp = cl.number - temp;
			    break;  
			case '*':  
			    temp *= cl.number;
			    break;  
			case '/':  
			    try {
			    	temp = cl.number / temp;
			    }  
			    catch(ArithmeticException excp) { 
			        cl.displayLabel.setText("Divide by 0.");
			        return;
			    }  
			    break;  
		}	// switch  
		  
		cl.displayLabel.setText(Calculator.getFormattedText(temp));  
	}	// actionPerformed  
}	// class MyOperatorButton


class MySpecialButton extends Button implements ActionListener {
	Calculator cl;  
	  
	MySpecialButton(int x, int y, int width, int height, String cap, Calculator clc) {  
		super(cap);  
		setBounds(x, y, width, height);  
		this.cl = clc;  
		this.cl.add(this);  
		addActionListener(this);  
	}  

	public void actionPerformed(ActionEvent ev) { 
		String opText = ((MySpecialButton)ev.getSource()).getLabel();  
		// check for "Off" button  
		if(opText.equals("Off")) {
			System.exit(0);  
		}  
		
		// check for "C" button
		if(opText.equals("C")) {   
			cl.number = 0.0;
			cl.op = ' ';
			cl.memValue = 0.0;  
			cl.displayLabel.setText("0");
			cl.setClear=true;
		}  
		  
		// check for "CE" button
		if(opText.equals("CE")) {
			cl.displayLabel.setText("0");
			cl.setClear=true;
		}
	}	// actionPerformed  
}	// class MySpecialButton
